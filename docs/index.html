<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitwise Numerics Explorer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0f172a;
            min-height: 100vh;
            color: #e2e8f0;
            margin: 0;
        }

        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 320px;
            background: #1e293b;
            border-right: 1px solid #334155;
            overflow-y: auto;
            box-shadow: 4px 0 12px rgba(0, 0, 0, 0.3);
        }

        .content {
            margin-left: 320px;
            padding: 20px;
            min-height: 100vh;
        }

        .header {
            background: #1e293b;
            padding: 20px;
            border-bottom: 1px solid #334155;
            position: sticky;
            top: 0;
            z-index: 20;
        }

        .filters {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .filter-button {
            padding: 6px 12px;
            background: #334155;
            color: #e2e8f0;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
        }

            .filter-button:hover {
                background: #475569;
            }

            .filter-button.active {
                background: #6366f1;
                border-color: #818cf8;
            }

        .category-header {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            cursor: pointer;
            transition: all 0.2s;
            background: #1e293b;
            border-left: 3px solid transparent;
            font-weight: 600;
            color: #e2e8f0;
            user-select: none;
        }

            .category-header:hover {
                background: #2d3748;
                border-left-color: #6366f1;
            }

            .category-header.active {
                background: #334155;
                border-left-color: #6366f1;
                color: #818cf8;
            }

        .category-icon {
            width: 24px;
            height: 24px;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .subcategory-list {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: #0f172a;
        }

            .subcategory-list.active {
                max-height: 1200px;
            }

        .subcategory-item {
            padding: 10px 16px 10px 50px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid transparent;
            color: #cbd5e1;
            font-size: 13px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

            .subcategory-item:hover {
                background: #1e293b;
                border-left-color: #6366f1;
                color: #e2e8f0;
            }

            .subcategory-item.selected {
                background: #334155;
                border-left-color: #6366f1;
                color: #818cf8;
                font-weight: 500;
            }

        .format-badge {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
        }

        .badge-fixed {
            background: #059669;
            color: #d1fae5;
        }

        .badge-variable {
            background: #d97706;
            color: #fed7aa;
        }

        .badge-arbitrary {
            background: #7c3aed;
            color: #e9d5ff;
        }

        .format-details {
            background: #1e293b;
            border-radius: 8px;
            border: 1px solid #334155;
            padding: 24px;
            margin-bottom: 20px;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin-top: 16px;
        }

        .detail-card {
            background: #0f172a;
            padding: 16px;
            border-radius: 6px;
            border: 1px solid #334155;
        }

            .detail-card h4 {
                font-size: 12px;
                text-transform: uppercase;
                color: #94a3b8;
                margin-bottom: 8px;
                font-weight: 600;
                letter-spacing: 0.5px;
            }

            .detail-card .value {
                font-size: 16px;
                color: #e2e8f0;
                font-weight: 500;
            }

        .language-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }

        .language-card {
            background: #0f172a;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #334155;
        }

            .language-card .lang-name {
                font-weight: 600;
                color: #818cf8;
                margin-bottom: 6px;
                font-size: 14px;
            }

            .language-card .support-type {
                font-size: 12px;
                color: #cbd5e1;
                margin-bottom: 4px;
            }

            .language-card .native {
                color: #34d399;
                font-weight: 500;
            }

            .language-card .library {
                color: #fbbf24;
            }

            .language-card .none {
                color: #64748b;
            }

        .code-block {
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 6px;
            padding: 12px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 12px;
            color: #e2e8f0;
            overflow-x: auto;
            margin-top: 8px;
        }

        .governance-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin: 2px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .gov-ieee {
            background: #065f46;
            color: #d1fae5;
        }

        .gov-vendor {
            background: #92400e;
            color: #fed7aa;
        }

        .gov-defacto {
            background: #374151;
            color: #e5e7eb;
        }

        .gov-ietf {
            background: #1e3a8a;
            color: #dbeafe;
        }

        .gov-apache {
            background: #991b1b;
            color: #fecaca;
        }

        .gov-proprietary {
            background: #581c87;
            color: #e9d5ff;
        }

        .gov-proposed {
            background: #831843;
            color: #fce7f3;
        }

        .gov-languagestandard {
            background: #0e7490;
            color: #cffafe;
        }

        .gov-historical {
            background: #4c1d95;
            color: #ddd6fe;
        }

        .section-header {
            font-size: 18px;
            font-weight: 700;
            color: #818cf8;
            margin: 24px 0 12px 0;
            padding-bottom: 8px;
            border-bottom: 2px solid #334155;
        }

        .search-box {
            width: 100%;
            padding: 10px 14px;
            background: #0f172a;
            color: #e2e8f0;
            border: 1px solid #334155;
            border-radius: 6px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s;
        }

            .search-box:focus {
                border-color: #6366f1;
            }

        .expand-icon {
            margin-left: auto;
            transition: transform 0.3s;
        }

        .category-header.active .expand-icon {
            transform: rotate(90deg);
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #94a3b8;
        }

        @media (max-width: 1024px) {
            .sidebar {
                width: 280px;
            }

            .content {
                margin-left: 280px;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
            }

            .content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div style="padding: 20px; border-bottom: 1px solid #334155;">
            <h2 style="font-size: 20px; font-weight: 700; margin-bottom: 12px; color: #818cf8;">Numeric Formats</h2>
            <input type="text" id="searchInput" class="search-box" placeholder="Search formats...">
            <div id="loadStatus" style="font-size: 11px; color: #64748b; margin-top: 8px;"></div>
        </div>
        <div id="menu"></div>
    </div>

    <div class="content">
        <div class="header">
            <h1 style="font-size: 28px; font-weight: 700; color: #e2e8f0;">Bitwise Numerics Explorer</h1>
            <div class="filters" id="filters">
                <span style="color: #94a3b8; font-size: 13px; margin-right: 8px;">Filter by:</span>
            </div>
        </div>

        <div id="format-details" class="loading">Loading formats...</div>
    </div>

    <script>let allFormats = [];
    let activeFilters = new Set();

    async function fetchFormats() {
      const files = [
        'arbitrary_precision_formats.json',
        'comprehensive_formats.json',
        'database_graphics_formats.json',
        'historical_specialized_formats.json',
        'language_ecosystem_formats.json',
        'ml_scientific_formats.json',
        'platform_specific_formats.json',
        'specialized_formats.json'
      ];

      const formats = [];
      const status = document.getElementById('loadStatus');
      let loaded = 0;

      for (const file of files) {
        try {
          const response = await fetch(file);
          if (response.ok) {
            const data = await response.json();
            formats.push(...data);
            loaded++;
            status.textContent = `Loaded ${loaded}/${files.length} files`;
          }
        } catch (error) {
          console.warn(`Could not fetch ${file}:`, error);
        }
      }

      status.textContent = `✓ ${loaded} files loaded`;
      return formats;
    }

    function categorizeFormats(formats) {
      const categories = {};
      formats.forEach(format => {
        const category = format.category || 'other';
        if (!categories[category]) categories[category] = [];
        categories[category].push(format);
      });
      return categories;
    }

    function getCategoryConfig(category) {
      const configs = {
        'integer': { icon: '🔢', name: 'Integer', color: '#10b981' },
        'float': { icon: '∞', name: 'Floating Point', color: '#3b82f6' },
        'decimal': { icon: '💰', name: 'Decimal', color: '#f59e0b' },
        'rational': { icon: '÷', name: 'Rational', color: '#8b5cf6' },
        'symbolic': { icon: 'π', name: 'Symbolic', color: '#ec4899' },
        'interval': { icon: '[]', name: 'Interval', color: '#06b6d4' },
        'vector_processing': { icon: '⚡', name: 'Vector/SIMD', color: '#f97316' },
        'complex': { icon: 'ℂ', name: 'Complex', color: '#f472b6' },
        'fixed_point': { icon: '•', name: 'Fixed Point', color: '#14b8a6' },
        'other': { icon: '◆', name: 'Other', color: '#6b7280' }
      };
      return configs[category] || { icon: '?', name: category, color: '#6b7280' };
    }

    function getBitsBadge(bits) {
      if (bits === 'variable' || bits === 'symbolic') {
        return '<span class="format-badge badge-variable">VAR</span>';
      } else if (typeof bits === 'string' && bits.includes('arbitrary')) {
        return '<span class="format-badge badge-arbitrary">∞</span>';
      } else {
        return '<span class="format-badge badge-fixed">' + bits + 'b</span>';
      }
    }

    function renderMenu(categorizedFormats) {
      const menu = document.getElementById('menu');
      menu.innerHTML = '';

      Object.entries(categorizedFormats).sort().forEach(([category, formats]) => {
        const config = getCategoryConfig(category);

        const categoryDiv = document.createElement('div');
        categoryDiv.className = 'menu-category';

        const header = document.createElement('div');
        header.className = 'category-header';
        header.innerHTML = `
          <span class="category-icon">${config.icon}</span>
          <span style="flex: 1;">${config.name}</span>
          <span style="background: #334155; padding: 2px 8px; border-radius: 12px; font-size: 11px;">${formats.length}</span>
          <span class="expand-icon">▸</span>
        `;

        const subcategoryList = document.createElement('div');
        subcategoryList.className = 'subcategory-list';

        formats.sort((a, b) => a.name.localeCompare(b.name)).forEach(format => {
          const item = document.createElement('div');
          item.className = 'subcategory-item';
          item.innerHTML = `
            <span>${format.name}</span>
            ${getBitsBadge(format.bits_total)}
          `;
          item.dataset.formatName = format.name;
          item.addEventListener('click', () => {
            document.querySelectorAll('.subcategory-item').forEach(i => i.classList.remove('selected'));
            item.classList.add('selected');
            renderFormatDetails(format);
          });
          subcategoryList.appendChild(item);
        });

        header.addEventListener('click', () => {
          header.classList.toggle('active');
          subcategoryList.classList.toggle('active');
        });

        categoryDiv.appendChild(header);
        categoryDiv.appendChild(subcategoryList);
        menu.appendChild(categoryDiv);
      });
    }

    function renderFormatDetails(format) {
      const details = document.getElementById('format-details');
      const govClass = 'gov-' + (format.governance?.type || 'other').replace(/[^a-zA-Z]/g, '').toLowerCase();

      let html = `
        <div class="format-details">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px; flex-wrap: wrap;">
            <h2 style="font-size: 32px; font-weight: 700; color: #e2e8f0; margin: 0;">${format.name}</h2>
            ${getBitsBadge(format.bits_total)}
            ${format.governance ? `<span class="governance-badge ${govClass}">${format.governance.type}</span>` : ''}
          </div>

          <div class="detail-grid">
            <div class="detail-card">
              <h4>Category</h4>
              <div class="value">${getCategoryConfig(format.category).name}</div>
            </div>
            <div class="detail-card">
              <h4>Total Bits</h4>
              <div class="value">${format.bits_total}</div>
            </div>
            <div class="detail-card">
              <h4>Signed</h4>
              <div class="value">${format.signed === null ? 'N/A' : format.signed ? 'Yes' : 'No'}</div>
            </div>
            <div class="detail-card">
              <h4>Range</h4>
              <div class="value" style="font-size: 13px;">${format.range || 'N/A'}</div>
            </div>
            ${format.values ? `
            <div class="detail-card">
              <h4>Distinct Values</h4>
              <div class="value">${format.values}</div>
            </div>` : ''}
            ${format.bit_split ? `
            <div class="detail-card">
              <h4>Bit Layout</h4>
              <div class="value" style="font-family: monospace; font-size: 13px;">${format.bit_split}</div>
            </div>` : ''}
          </div>
      `;

      if (format.structure) {
        html += `
          <div class="section-header">Structure</div>
          <div class="detail-grid">
            ${format.structure.sign_bits ? `
            <div class="detail-card">
              <h4>Sign Bits</h4>
              <div class="value">${format.structure.sign_bits}</div>
            </div>` : ''}
            ${format.structure.exponent_bits ? `
            <div class="detail-card">
              <h4>Exponent Bits</h4>
              <div class="value">${format.structure.exponent_bits}</div>
            </div>` : ''}
            ${format.structure.mantissa_bits ? `
            <div class="detail-card">
              <h4>Mantissa Bits</h4>
              <div class="value">${format.structure.mantissa_bits}</div>
            </div>` : ''}
            ${format.structure.bias ? `
            <div class="detail-card">
              <h4>Bias</h4>
              <div class="value">${format.structure.bias}</div>
            </div>` : ''}
          </div>
        `;

        if (format.structure.specials) {
          html += `
          <div style="margin-top: 16px;">
            <strong style="color: #94a3b8;">Special Values:</strong>
            <span style="color: #e2e8f0; margin-left: 8px;">
              Zeros: ${format.structure.specials.zeros} |
              Infinities: ${format.structure.specials.infinities} |
              NaNs: ${format.structure.specials.nans} |
              Subnormals: ${format.structure.specials.subnormals}
            </span>
          </div>`;
        }
      }

      if (format.governance) {
        html += `
          <div class="section-header">Governance</div>
          <div style="color: #cbd5e1;">
            ${format.governance.owner ? `<p><strong style="color: #94a3b8;">Owner:</strong> ${format.governance.owner}</p>` : ''}
            ${format.governance.status ? `<p><strong style="color: #94a3b8;">Status:</strong> ${format.governance.status}</p>` : ''}
            ${format.governance.notes ? `<p><strong style="color: #94a3b8;">Notes:</strong> ${format.governance.notes}</p>` : ''}
          </div>
        `;
      }

      if (format.arbitrary_precision_config) {
        html += `
          <div class="section-header">Arbitrary Precision Configuration</div>
          <div class="detail-grid">
            <div class="detail-card">
              <h4>Precision Type</h4>
              <div class="value">${format.arbitrary_precision_config.precision_type}</div>
            </div>
            ${format.arbitrary_precision_config.memory_scaling ? `
            <div class="detail-card">
              <h4>Memory Scaling</h4>
              <div class="value" style="font-size: 14px;">${format.arbitrary_precision_config.memory_scaling}</div>
            </div>` : ''}
          </div>
        `;

        if (format.arbitrary_precision_config.computational_complexity) {
          html += `
            <div style="margin-top: 12px;">
              <strong style="color: #94a3b8;">Computational Complexity:</strong>
              <div class="code-block" style="margin-top: 8px;">
                Addition: ${format.arbitrary_precision_config.computational_complexity.addition || 'N/A'}<br>
                Multiplication: ${format.arbitrary_precision_config.computational_complexity.multiplication || 'N/A'}<br>
                Division: ${format.arbitrary_precision_config.computational_complexity.division || 'N/A'}
              </div>
            </div>
          `;
        }
      }

      if (format.hex_examples) {
        html += `
          <div class="section-header">Hex Examples</div>
          <div class="code-block">${JSON.stringify(format.hex_examples, null, 2)}</div>
        `;
      }

      if (format.binary_examples && format.binary_examples.length > 0) {
        html += `
          <div class="section-header">Binary Examples</div>
          <div class="code-block">${JSON.stringify(format.binary_examples, null, 2)}</div>
        `;
      }

      if (format.language_support && format.language_support.length > 0) {
        html += `<div class="section-header">Language Support</div>`;
        html += '<div class="language-grid">';

        format.language_support.forEach(lang => {
          const hasNative = lang.native_support && lang.native_support !== 'none';
          const hasLibrary = lang.library_support && lang.library_support.length > 0;

          let supportType = '';
          if (hasNative) {
            supportType = `<span class="native">Native: ${lang.native_support}</span>`;
          } else if (hasLibrary) {
            supportType = `<span class="library">Library: ${lang.library_support[0].library_name}</span>`;
          } else {
            supportType = '<span class="none">Not supported</span>';
          }

          html += `
            <div class="language-card">
              <div class="lang-name">${lang.language}</div>
              <div class="support-type">${supportType}</div>
              ${lang.notes ? `<div style="font-size: 11px; color: #64748b; margin-top: 4px;">${lang.notes}</div>` : ''}
            </div>
          `;
        });

        html += '</div>';
      }

      if (format.links && format.links.length > 0) {
        html += `<div class="section-header">Resources</div>`;
        format.links.forEach(link => {
          html += `<a href="${link.url}" target="_blank" style="display: block; color: #818cf8; margin: 8px 0; text-decoration: none; text-decoration: underline;">${link.text} →</a>`;
        });
      }

      html += '</div>';
      details.innerHTML = html;
    }

    function setupFilters() {
      const languages = new Set();
      allFormats.forEach(f => {
        if (f.language_support) {
          f.language_support.forEach(l => languages.add(l.language));
        }
      });

      const filters = document.getElementById('filters');
      const commonLangs = ['C', 'C++', 'C#', 'Java', 'Python', 'Rust', 'Go', 'JavaScript', 'Haskell', 'Julia', 'Swift', 'Kotlin'];

      commonLangs.forEach(lang => {
        if (languages.has(lang)) {
          const btn = document.createElement('button');
          btn.className = 'filter-button';
          btn.textContent = lang;
          btn.onclick = () => toggleFilter(lang, btn);
          filters.appendChild(btn);
        }
      });
    }

    function toggleFilter(lang, btn) {
      if (activeFilters.has(lang)) {
        activeFilters.delete(lang);
        btn.classList.remove('active');
      } else {
        activeFilters.add(lang);
        btn.classList.add('active');
      }
      applyFilters();
    }

    function applyFilters() {
      if (activeFilters.size === 0) {
        document.querySelectorAll('.subcategory-item').forEach(item => {
          item.style.display = '';
        });
        return;
      }

      document.querySelectorAll('.subcategory-item').forEach(item => {
        const formatName = item.dataset.formatName;
        const format = allFormats.find(f => f.name === formatName);

        if (format && format.language_support) {
          const hasSupport = format.language_support.some(l =>
            activeFilters.has(l.language) &&
            (l.native_support !== 'none' || (l.library_support && l.library_support.length > 0))
          );
          item.style.display = hasSupport ? '' : 'none';
        } else {
          item.style.display = 'none';
        }
      });
    }

    function setupSearch() {
      const searchInput = document.getElementById('searchInput');
      searchInput.addEventListener('input', (e) => {
        const query = e.target.value.toLowerCase();
        document.querySelectorAll('.subcategory-item').forEach(item => {
          const formatName = item.textContent.toLowerCase();
          const shouldShow = formatName.includes(query);
          item.style.display = shouldShow ? '' : 'none';
        });
      });
    }

    async function init() {
      allFormats = await fetchFormats();
      if (allFormats.length > 0) {
        const categorized = categorizeFormats(allFormats);
        renderMenu(categorized);
        setupSearch();
        setupFilters();
        renderFormatDetails(allFormats[0]);

        const firstCategory = document.querySelector('.category-header');
        if (firstCategory) firstCategory.click();

        const firstItem = document.querySelector('.subcategory-item');
        if (firstItem) firstItem.classList.add('selected');
      } else {
        document.getElementById('format-details').innerHTML =
          '<div class="format-details"><p style="color: #94a3b8;">No formats loaded. Make sure the JSON files are accessible.</p></div>';
      }
    }

    init();</script>
</body>
</html>